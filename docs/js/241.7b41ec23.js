"use strict";(self["webpackChunktodo_buudienxatulap"]=self["webpackChunktodo_buudienxatulap"]||[]).push([[241],{4026:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(9835),o=n(6970);const i={class:"text-bold text-subtitle1"};function s(e,t,n,s,r,c){const h=(0,a.up)("q-banner");return(0,a.wg)(),(0,a.j4)(h,{dense:"","inline-actions":"",class:(0,o.C_)([n.bgcolor,"list-header text-white text-center"])},{default:(0,a.w5)((()=>[(0,a._)("span",i,[(0,a.WI)(e.$slots,"default")])])),_:3},8,["class"])}const r={props:["bgcolor"]};var c=n(1639),h=n(7128),l=n(9984),d=n.n(l);const u=(0,c.Z)(r,[["render",s]]),p=u;d()(r,"components",{QBanner:h.Z})},3241:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L});var a=n(9835),o=n(6970),i=n(1957);const s={class:"q-pa-md"},r={class:"q-gutter-y-md column"},c=["href"];function h(e,t,n,h,l,d){const u=(0,a.up)("q-btn"),p=(0,a.up)("ListHeader"),m=(0,a.up)("q-icon"),g=(0,a.up)("q-input"),w=(0,a.up)("q-item-label"),k=(0,a.up)("q-item-section"),y=(0,a.up)("q-item"),I=(0,a.up)("q-separator"),T=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(p,{bgcolor:"bg-orange-4"},{default:(0,a.w5)((()=>[(0,a.Uk)("KHL "+(0,o.zw)(e.searchText)+" "+(0,o.zw)(e.doanhThu.toLocaleString())+"đ / "+(0,o.zw)(e.tongSoBuuGui)+" bưu gửi ",1),(0,a.Wm)(u,{rounded:"",color:"primary",onClick:t[0]||(t[0]=t=>e.copySoDienThoaiToClipboard()),icon:"content_copy"})])),_:1}),(0,a._)("div",r,[(0,a.Wm)(g,{outlined:"",modelValue:e.searchText,"onUpdate:modelValue":t[2]||(t[2]=t=>e.searchText=t),placeholder:"Từ khóa",hint:"Tìm kiếm theo thông tin thẻ BHYT",onKeyup:t[3]||(t[3]=(0,i.D2)((t=>e.traCuu()),["enter"])),dense:""},{append:(0,a.w5)((()=>[""!==e.searchText?((0,a.wg)(),(0,a.j4)(m,{key:0,name:"close",onClick:t[1]||(t[1]=t=>e.searchText=""),class:"cursor-pointer"})):(0,a.kq)("",!0),(0,a.Wm)(m,{name:"search"})])),_:1},8,["modelValue"])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.khls.sort((function(e,t){return t.soLuong-e.soLuong})),(e=>((0,a.wg)(),(0,a.j4)(T,{key:e.senderPhone},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.senderName),1)])),_:2},1024),(0,a.Wm)(w,{caption:"",lines:"2"},{default:(0,a.w5)((()=>[(0,a._)("a",{href:`tel:${e.senderPhone}`},(0,o.zw)(e.senderPhone),9,c)])),_:2},1024),(0,a.Wm)(w,{caption:"",lines:"2"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.senderAdd),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(k,{side:"",top:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.soLuong),1)])),_:2},1024),(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)("COD: "+(0,o.zw)(parseInt(e.tongCOD).toLocaleString()),1)])),_:2},1024),(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)("Cước: "+(0,o.zw)(parseInt(e.tongCuoc).toLocaleString()),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.Wm)(I,{spaced:"",inset:""})])),_:2},1024)))),128))])}n(702);var l=n(9981),d=n.n(l),u=n(6827),p=n(6950),m=n(8359),g=n(4026);const w=(0,a.aZ)({components:{ListHeader:g.Z},name:"KHLPage",data(){const[e,t,n]=(new Date).toISOString().slice(0,10).split("-");return{ngay:n,thang:t,nam:e,searchText:[t,e].join("/"),tokenFe:"eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJKRmNhcC1XZWJBcGkiLCJleHAiOjE2NzkwMTQ0MTcsIm5iZiI6MTY3ODQwOTMxNywiaWF0IjoxNjc4NDA5MzE3LCJhaWQiOiJLSEwiLCJ1aWQiOiIxNDIwMTBfVEhBTUhUIiwidWZuIjoiSOG7kyBUaOG7iyBUaOG6r20iLCJvcmciOiIxNDIwMTAiLCJvcmdFbXBsIjoiMTQyMDEwIiwiZGlkIjoiZWRkNjJlZWFhZGVjYjBiNjM1NDI4ODY3YjJlZDEwMGIiLCJsY3AiOjE2MzU4MTY3NDIwMDAsImV4cGlyYXRpb25EYXRlIjo5MH0.snnuvZdWzP94_9baQfbJITD_OiGA2gyVl1EJiPVX7x-nL7ej2jGmnNWSt7-G7x4h32zxz4rLe9SZtJP3OzRFsw",dsDonHang:[],khls:[],tongSoBuuGui:0,doanhThu:0}},methods:{sleep(){return new Promise((e=>setTimeout(e,1500)))},async login(){var e=JSON.stringify({username:"142010_THAMHT",password:"Abc@123456789",ip:"",random:.8677049060452371}),t={method:"post",maxBodyLength:1/0,url:"https://api-portalkhl.vnpost.vn/api/auth/signinKhl",headers:{capikey:"19001235","Content-Type":"application/json"},data:e};const{data:{tokenFe:n}}=await d().post("https://api-portalkhl.vnpost.vn/api/auth/signinKhl",e,t);this.tokenFe=n},async loadData(){this.dsDonHang=[],this.tokenFe||await this.login();var e=JSON.stringify({orgCode:"142010",tuNgay:[1,parseInt(this.thang),this.nam].join("/"),denNgay:new Date(this.nam,parseInt(this.thang),1).toISOString().slice(0,10).split("-").reverse().join("/"),pageNum:0,pageSize:5e3,sourceSystem:"KHL"}),t={method:"post",maxBodyLength:1/0,url:"https://api-portalkhl.vnpost.vn/khl/getItemDtl",headers:{Authorization:`Bearer ${this.tokenFe}`,"Content-Type":"application/json"},data:e};p.Z.show({spinner:m.Z,spinnerSize:"100px"});const{data:[n,a]}=await d()(t);this.tongSoBuuGui=n,this.doanhThu=a.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0),p.Z.hide(),this.dsDonHang=a;const o=new Map,i=a.map((({senderPhone:e,senderName:t,senderAdd:n})=>({senderPhone:e,senderName:t,senderAdd:n})));for(let s=0;s<i.length;s++){const e=i[s];if(!o.has(e.senderPhone)){const t=a.filter((t=>t.senderPhone===e.senderPhone));o.set(e.senderPhone,{...e,soLuong:t.length,tongCuoc:t.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0),tongCOD:t.filter((e=>e.codAmount)).reduce(((e,{codAmount:t})=>e+parseInt(t)),0)})}}this.khls=[...o.values()]},async traCuu(){const[e,t]=this.searchText.split("/");this.thang=e,this.nam=t,this.loadData()},async findItems(e){return this.dsDonHang.filter((t=>t.senderPhone===e))},async tongCuoc(e){return e.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0)},async updateItem({ttNumber:e,senderPhone:t,totalFeeSpecial:n,codAmount:a,updatedDate:o,createdDate:i}){d().put(`https://192.168.1.7:2024/api/khls/${e}`,{soTien:n,ghiNo:a,ten:t,updatedDate:o.toString().slice(0,10),createdDate:i.toString().slice(0,10)})},copyTextToClipboard(e){navigator.clipboard.writeText(`Để theo dõi định vị bưu gửi https://www.hotham.vn/tra-cuu-hang-buu-dien?q=${e}. (Bạn chỉ cần bấm vào link)`).then((function(){u.Z.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){u.Z.create({type:"negative",message:"Không thực hiện được!"+e})}))},copySoDienThoaiToClipboard(){navigator.clipboard.writeText(this.khls.map((e=>e.senderPhone)).join()).then((function(){u.Z.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){u.Z.create({type:"negative",message:"Không thực hiện được!"+e})}))}},mounted(){this.loadData()}});var k=n(1639),y=n(4455),I=n(361),T=n(2857),f=n(3246),D=n(490),Z=n(1233),b=n(3115),v=n(2218),S=n(9984),x=n.n(S);const C=(0,k.Z)(w,[["render",h]]),L=C;x()(w,"components",{QBtn:y.Z,QInput:I.Z,QIcon:T.Z,QList:f.Z,QItem:D.Z,QItemSection:Z.Z,QItemLabel:b.Z,QSeparator:v.Z})}}]);