"use strict";(globalThis["webpackChunktodolist"]=globalThis["webpackChunktodolist"]||[]).push([[532],{9532:(e,t,a)=>{a.r(t),a.d(t,{default:()=>J});var n=a(1758),i=a(9104),l=a(8790);const o={class:"row"},s={class:"col-6"},h={class:"col-4"},u={class:"col-2 text-right"},c=(0,n.Lk)("br",null,null,-1),r=(0,n.Lk)("br",null,null,-1);function d(e,t,a,d,g,m){const T=(0,n.g2)("q-icon"),p=(0,n.g2)("q-input"),k=(0,n.g2)("q-select"),b=(0,n.g2)("q-item-section"),y=(0,n.g2)("q-item"),B=(0,n.g2)("q-list"),f=(0,n.g2)("q-menu"),H=(0,n.g2)("q-card-section"),C=(0,n.g2)("q-expansion-item"),X=(0,n.g2)("ThongTinTheBHYT"),D=(0,n.g2)("q-separator"),_=(0,n.g2)("q-card"),v=(0,n.g2)("BhytUpdateDialog"),W=(0,n.g2)("q-dialog"),S=(0,n.g2)("q-page"),N=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(S,{padding:""},{default:(0,n.k6)((()=>[(0,n.bF)(_,null,{default:(0,n.k6)((()=>[(0,n.bF)(H,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",o,[(0,n.Lk)("div",s,[(0,n.bF)(p,{label:"Tìm kiếm",outlined:"",modelValue:m.searchText,"onUpdate:modelValue":t[1]||(t[1]=e=>m.searchText=e),debounce:"900",ref:"inputSearch",onKeyup:t[2]||(t[2]=(0,i.jR)((e=>m.timKiem(m.searchText)),["enter"])),dense:""},{append:(0,n.k6)((()=>[""===m.searchText?((0,n.uX)(),(0,n.Wv)(T,{key:0,name:"search"})):((0,n.uX)(),(0,n.Wv)(T,{key:1,name:"clear",class:"cursor-pointer",onClick:t[0]||(t[0]=e=>m.searchText="")}))])),_:1},8,["modelValue"])]),(0,n.Lk)("div",h,[(0,n.bF)(k,{modelValue:g.selectedUser,"onUpdate:modelValue":[t[3]||(t[3]=e=>g.selectedUser=e),e.selectUser],options:m.userOptions,label:"Lọc theo người dùng",outlined:"","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,n.Lk)("div",u,[(0,n.eW)(" Menu "),(0,n.bF)(T,{name:"expand_more",dense:""}),e.userDetails.isPro?((0,n.uX)(),(0,n.Wv)(f,{key:0,"touch-position":""},{default:(0,n.k6)((()=>[(0,n.bF)(B,{style:{"min-width":"100px"}},{default:(0,n.k6)((()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytByName},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tìm tất cả")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[4]||(t[4]=e=>m.loadBhytByUserName(1))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã thu tiền BHYT")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[5]||(t[5]=e=>m.loadBhytByUserName(0))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã thu tiền BHXH")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.taiTucBHYT1thang},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục 1 tháng ("+(0,l.v_)(e.userDetails.id)+")",1)])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.taiTucBHYT2thang},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục 2 tháng ("+(0,l.v_)(e.userDetails.id)+")",1)])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[6]||(t[6]=e=>m.loadBhyts({thang:1}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục 1 tháng (xã)")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[7]||(t[7]=e=>m.loadBhyts({thang:2}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục 2 tháng (xã)")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[8]||(t[8]=t=>m.loadBHXHTNs({tienNop:1,taiTucBHXH:1,userName:e.userDetails.id}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục BHXH")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[9]||(t[9]=t=>m.loadBHXHTNs({tienNop:1,userName:e.userDetails.id}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("BHXH "+(0,l.v_)(e.userDetails.id),1)])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[10]||(t[10]=t=>m.loadBHXHTNs({tienNop:1,maXa:e.userDetails.maXa}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("BHXH (xã)")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadTaiTucBHYTBT},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("BHYT bổ trợ")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytThang},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã nộp BHYT")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBHXHThang},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã nộp BHXH TN")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytsHetHan},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã hết hạn")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytsDisable},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã liên hệ")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytsCompleted},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đánh dấu sao")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBaoCaoChiTietGiaoDich},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Báo cáo Chi Tiết Giao Dịch")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.inC17},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("In C17")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.printDanhSachTraThe},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("In Danh sách trả thẻ")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.copyMaSoBhxhToClipboard},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Copy tất cả mã số BHXH")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:e.copyHoTenToClipboard},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Copy tất cả họ tên")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.copySoDienThoaiToClipboard},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Copy tất cả số điện thoại")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.copyNamePhoneClipboard},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Lưu danh bạ")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:e.batTatRemove},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tắt/Bật danh sách")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[11]||(t[11]=e=>m.timMoi(m.searchText))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tìm mới")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadBhytByNamSinh},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tìm theo năm sinh")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadTaiTucBHYT},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục BHYT (ssm)")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:m.loadTaiTucBHXH},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục BHXH (ssm)")])),_:1})])),_:1},8,["onClick"])),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[12]||(t[12]=t=>e.capNhatBHXHTN(m.searchText))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đồng bộ BHXH TN")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[13]||(t[13]=t=>e.resetBhyt(m.searchText?e.bhyts.filter((e=>e.userName!==m.searchText)):[]))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Xóa danh sách")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[14]||(t[14]=t=>e.resetBhyt(m.searchText?e.bhyts.filter((e=>e.userName===m.searchText)):[]))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Giữ lại danh sách")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[15]||(t[15]=t=>e.resetBhyt(m.searchText?e.bhyts.filter((e=>!(e.soDienThoai||e.soDienThoai2))):[]))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Thiếu số điện thoại")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[16]||(t[16]=t=>m.loadBHXHTNs({isCMND:1,maXa:e.userDetails.maXa}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Thiếu CCCD")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[17]||(t[17]=e=>m.loadBhytByUserNameTaiTuc())},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Tái tục")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[18]||(t[18]=t=>e.getBhyts({isPhone:!0,maXa:e.userDetails.maXa,name:m.searchText}))},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Có số điện thoại")])),_:1})])),_:1})),[[N]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(y,{clickable:"",onClick:t[19]||(t[19]=e=>m.loadBhytByUserName())},{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.eW)("Đã thu tiền")])),_:1})])),_:1})),[[N]])])),_:1})])),_:1})):(0,n.Q3)("",!0)])])])),_:1}),e.filteredBhyts.length?((0,n.uX)(),(0,n.Wv)(H,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(C,{modelValue:g.expanded,"onUpdate:modelValue":t[20]||(t[20]=e=>g.expanded=e),label:`Tổng tiền: ${parseInt(m.tongTienBHYT).toLocaleString()}/ ${e.filteredBhyts.length} thẻ`,caption:"Xem chi tiết"},{default:(0,n.k6)((()=>[(0,n.eW)(" Hoa hồng BHYT: "+(0,l.v_)(parseInt((.0264*m.tongTienBHYT).toFixed(0)).toLocaleString())+" ("+(0,l.v_)(parseInt((m.tongTienBHYT/(e.filteredBhyts.length||1)*.0264).toFixed(0)).toLocaleString())+"/thẻ) ",1),c,(0,n.eW)(" Hoa hồng BHXH (năm): "+(0,l.v_)(parseInt((.049*(.22*e.tongMucDongBHXH-66e3*e.tongSoBHXH)*12).toFixed(0)).toLocaleString())+"đ ("+(0,l.v_)(parseInt(e.tongMucDongBHXH).toLocaleString())+") ",1),r,(0,n.Lk)("span",null,"Có "+(0,l.v_)(e.tongSoBHXH)+" BHXHTN (tái tục): "+(0,l.v_)(parseInt((.049*e.tongTienBHXH).toFixed(0)).toLocaleString())+" ("+(0,l.v_)(parseInt(e.tongTienBHXH).toLocaleString())+") ",1)])),_:1},8,["modelValue","label"]),(0,n.bF)(B,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.filteredBhyts,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id},[(0,n.bF)(X,{bhyt:e},null,8,["bhyt"]),(0,n.bF)(D,{spaced:"",inset:""})])))),128))])),_:1})])),_:1})):((0,n.uX)(),(0,n.Wv)(H,{key:1},{default:(0,n.k6)((()=>[(0,n.eW)(" Nhập họ và tên hoặc mã số BHXH, mã thẻ BHYT vào ô Tìm kiếm và nhấn ENTER để tra cứu. ")])),_:1}))])),_:1}),(0,n.bF)(W,{modelValue:g.dialogShow,"onUpdate:modelValue":t[21]||(t[21]=e=>g.dialogShow=e),persistent:""},{default:(0,n.k6)((()=>[(0,n.bF)(v)])),_:1},8,["modelValue"])])),_:1})}a(3009),a(3647),a(7458),a(1807),a(5512),a(5263),a(9875),a(4559);var g=a(6980),m=a(2494),T=a(1627);const p=(0,n.Lk)("div",{class:"text-h6"},"Cập nhật thông tin BHYT",-1);function k(e,t,a,i,l,o){const s=(0,n.g2)("q-space"),h=(0,n.g2)("q-btn"),u=(0,n.g2)("q-card-section"),c=(0,n.g2)("q-input"),r=(0,n.g2)("q-form"),d=(0,n.g2)("q-card"),g=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(d,null,{default:(0,n.k6)((()=>[(0,n.bF)(u,{class:"row items-center q-pb-lg"},{default:(0,n.k6)((()=>[p,(0,n.bF)(s),(0,n.bo)((0,n.bF)(h,{icon:"close",flat:"",round:"",dense:""},null,512),[[g]])])),_:1}),(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,{onSubmit:o.submit,class:"q-gutter-md"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{modelValue:o.form.maPhuongThucDong,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.maPhuongThucDong=e),label:"Phương thức đóng (1,3,6,12 tháng)"},null,8,["modelValue"]),(0,n.bF)(c,{modelValue:o.form.mucDong,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.mucDong=e),label:"Mức thu nhập lựa chọn"},null,8,["modelValue"]),(0,n.bF)(c,{modelValue:o.form.denThangDt,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.denThangDt=e),type:"date",label:"Đến tháng"},null,8,["modelValue"]),(0,n.bF)(h,{type:"submit",label:"Lưu",color:"primary"})])),_:1},8,["onSubmit"])])),_:1})])),_:1})}const b={name:"BhytUpdateDialog",computed:{...(0,g.L8)("bhyts",["getCurrentBhyt"]),form(){return{maSoBhxh:this.getCurrentBhyt.maSoBhxh,mucDong:this.getCurrentBhyt.mucDong,maPhuongThucDong:this.getCurrentBhyt.maPhuongThucDong,denThangDt:this.getCurrentBhyt.denThangDt}}},methods:{...(0,g.i0)("bhyts",["setCurrentBhyt","updateDenNgayBHXH"]),async submit(){await this.updateDenNgayBHXH(this.form),this.setCurrentBhyt(null)}}};var y=a(2807),B=a(3316),f=a(4189),H=a(3676),C=a(1693),X=a(9200),D=a(9270),_=a(8672),v=a(8582),W=a.n(v);const S=(0,y.A)(b,[["render",k]]),N=S;W()(b,"components",{QCard:B.A,QCardSection:f.A,QSpace:H.A,QBtn:C.A,QForm:X.A,QInput:D.A}),W()(b,"directives",{ClosePopup:_.A});var x=a(660);function F(e){if(e=e.trim(),e.split(" ").length<2)return!1;const t=e.split(" ");for(let a=0;a<t.length;a++)if(!/^[A-Za-z]+$/.test(t[a]))return!1;return!0}function L(e){const t=e.match(/\d+/g),a=t?.join("");return a&&a.length>=10?a.slice(-10):""}function w(e){return 12===e.length&&!!/^\d+$/.test(e)}function $(e){return e.split("|")[0]}function A(e){if(10!==e.length)return!1;if(!/^\d+$/.test(e))return!1;const t=e.substring(0,2),a=["09","03","07","08"];return!!a.includes(t)}function I(e){const t=$(e);return w(t)?"Số CCCD":A(t)?"Số điện thoại di động":F(t)?"Họ và tên":10===L(t).length?"Dãy 10 chữ số cuối":"Loại chuỗi không xác định"}const q={components:{ThongTinTheBHYT:m.A,BhytUpdateDialog:N},data(){return{tuNgayDenNgay:"",soBienLai:"",selectedUser:null,dialogShow:!1,expanded:!1}},computed:{...(0,g.L8)("bhyts",["bhyts","filteredBhyts","tongTienBHXH","tongMucDongBHXH","tongSoBHXH","getCurrentBhyt"]),...(0,g.aH)("auth",["userDetails"]),userOptions(){return[{label:"Tất cả",value:null},{label:this.userDetails?.id,value:this.userDetails?.id},{label:this.userDetails?.maNhanVienThu?.slice(0,4),value:this.userDetails?.maNhanVienThu}]},tongTienBHYT(){return 0===this.filteredBhyts.length?0:this.filteredBhyts.map((e=>e.tongTien||0)).reduce(((e,t)=>e+parseInt(t)),0)},searchText:{get(){return this.$store.state.bhyts.searchText},set(e){this.$store.commit("bhyts/SET_SEARCH_TEXT",e)}}},methods:{...(0,g.i0)("bhyts",["getBhyts","resetBhyt","traCuuBhyts","updateBhyt","hoSoDaXuLy","dongBoDuLieu","traCuuTheoTen","getDanhSachKhachHangTaiTuc","copyHoTenToClipboard","batTatRemove","capNhatBHXHTN","searchBhyts","selectUser","traCuuBHXH","traCuuMaSoBHXH"]),...(0,g.i0)("auth",["firebaseUpdateUser","handleAuthStateChanged"]),...(0,g.PY)({setSearchText:"bhyts/SET_SEARCH_TEXT"}),sleep(e){return new Promise((t=>setTimeout(t,e)))},taiTucBHYT1thang(){this.getBhyts({thang:1,completed:"0",disabled:"0",taiTuc:"1",userName:this.userDetails.id})},taiTucBHYT2thang(){this.getBhyts({thang:2,completed:"0",disabled:"0",taiTuc:"1",userName:this.userDetails.id})},async loadTaiTucBHXH(){const e=await this.getDanhSachKhachHangTaiTuc({filterItems:[],maxResultCount:500,skipCount:0,mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId,tuThang:"2020-01-01 00:00:00",denThang:"2025-01-01 00:00:00",type:-1,loaiDichVu:0});this.capNhatBHXHTN([...new Set(e.map((e=>e.maSoBHXH)))].join())},async loadTaiTucBHYT(){const e=await this.getDanhSachKhachHangTaiTuc({filterItems:[],maxResultCount:5e3,skipCount:0,mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId,tuThang:"2020-01-01 00:00:00",denThang:"2025-01-01 00:00:00",type:-1,loaiDichVu:1});this.dongBoDuLieu([...new Set(e.map((e=>e.maSoBHXH)))].join())},async loadBaoCaoChiTietGiaoDich(){const e=new Date,t=e.getFullYear(),a=e.getMonth();2!==this.searchText.split(" : ").length&&(this.tuNgayDenNgay=this.searchText=`${new Date(t,a-2,1).toISOString().slice(0,10)} : ${new Date(2024,12,31).toISOString().slice(0,10)}`),this.$q.dialog({title:"Báo cáo chi tiết giao dịch",message:"Từ ngày : đến ngày?",prompt:{model:this.searchText,type:"text"},cancel:!0,persistent:!0}).onOk((async e=>{const t=e.split(" : ");try{await this.hoSoDaXuLy({tuNgay:t[0],denNgay:t[1],mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId})}catch(a){T.A.create({message:"Không thể kế nối đến máy chủ !",color:"red"})}}))},async inC17(){if(!this.bhyts.length&&!this.tuNgayDenNgay)return T.A.create({type:"negative",message:"Vào báo cáo giao dịch trước khi xuất C17."}),void this.loadBaoCaoChiTietGiaoDich();this.$q.dialog({title:"In C17 (quyển)",message:"Số biên lai?",prompt:{model:this.soBienLai,type:"text"},cancel:!0,persistent:!0}).onOk((async e=>{if(!e)return;const t=new Map;for(let o=1;o<10;o++)await t.set(`${e}0${o}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${e}0${o}`,ngayLap:null});for(let o=10;o<100;o++)await t.set(`${e}${o}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${e}${o}`,ngayLap:null});await t.set(`${parseInt(e+99)+1}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${parseInt(e+99)+1}`,ngayLap:null});const a=await this.bhyts.filter((t=>t.soBienLai.startsWith(e)));if(!a.length)return T.A.create({type:"negative",message:"Không tìm thấy quyển biên lai!"}),null;for(let o=0;o<this.bhyts.length;o++){const e=this.bhyts[o];if(t.has(e.soBienLai)){const a=t.get(e.soBienLai);t.set(e.soBienLai,{...a,ngayLap:e.ngayLap,tienBHYT:1===e.maThuTuc?parseInt(e.tongTien)+a.tienBHYT:a.tienBHYT,tienBHXH:0===e.maThuTuc?parseInt(e.tongTien)+a.tienBHXH:a.tienBHXH,tongTien:parseInt(e.tongTien)+a.tongTien})}}await this.sleep(1e3);const n=await fetch(`https://app.hotham.vn/api/mau-c17-all/1/pdf?tienBHYT=${a.filter((e=>1==e.maThuTuc)).map((e=>e.tongTien)).reduce(((e,t)=>e+t),0)}&tienBHXH=${a.filter((e=>0==e.maThuTuc)).map((e=>e.tongTien)).reduce(((e,t)=>e+t),0)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([...t.values()])}),i=await n.blob();if(i.errors)throw console.error(i.errors),new Error("Failed to fetch API");var l=document.createElement("a");l.href=window.URL.createObjectURL(i),l.download=`${(new Date).toISOString().slice(0,10)}-tham-tu-lap-c17.pdf`,l.click()}))},async print(e){let t=document.createElement("a");t.target="_blank";let a=`https://app.hotham.vn/mau-c17/${(new Date).toISOString().slice(0,10)}/pdf?maSoBhxhs=${e}`;t.href=a,t.click()},loadBhytByNamSinh(){this.$q.dialog({title:"Tìm thẻ BHYT theo năm sinh",message:"Nhập năm sinh?",prompt:{model:this.searchText,isValid:e=>4==e.length,type:"number"},cancel:!0,persistent:!0}).onOk((e=>{this.getBhyts({completed:"0",disabled:"0",maXa:this.userDetails.maXa,nam:e})}))},loadBhytByUserNameTaiTuc(){this.getBhyts({userName:this.searchText,completed:"0",disabled:"0"})},loadBhytByUserName(e){this.searchText,1===e?this.getBhyts({userName:this.userDetails.maNhanVienThu,isBHYT:1}):0===e?this.getBhyts({userName:this.userDetails.maNhanVienThu,isBHXHTN:1}):this.getBhyts({userName:this.searchText})},loadBhytByName(){this.$q.dialog({title:"Tìm thẻ BHYT",message:"Nhập nội dung tìm kiếm?",prompt:{model:this.searchText,isValid:e=>e.length>=2,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.getBhyts({name:e,maXa:e.length<9?this.userDetails.maXa:null})}))},loadBhytThang(){this.$q.dialog({title:"Tháng biên lai",message:"Nhập tháng?",prompt:{model:(new Date).getMonth()+1,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.getBhyts({thangBienLai:e,userName:this.userDetails.id})}))},loadBHXHThang(){this.$q.dialog({title:"Tháng biên lai",message:"Nhập tháng?",prompt:{model:(new Date).getMonth()+1,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.getBhyts({thangBienLaiTN:e,userName:this.userDetails.id})}))},loadBhyts({thang:e=1}){this.searchText="",this.getBhyts({thang:e,completed:"0",disabled:"0",taiTuc:"1",maXa:this.userDetails.maXa,name:this.searchText})},loadTaiTucBHYTBT(){this.searchText="",this.getBhyts({maXa:this.userDetails.maXa,taiTucBHYTBT:"1"})},loadBHXHTNs(e){this.getBhyts({...e,name:this.searchText})},loadBhytsHetHan(){this.getBhyts({maXa:this.userDetails.maXa,completed:"0",disabled:"0",hetHan:"1",name:this.searchText})},loadBhytsDisable(){this.getBhyts({maXa:this.userDetails.maXa,disabled:1})},loadBhytsCompleted(){this.getBhyts({maXa:this.userDetails.maXa,completed:1,disabled:"0"})},async timKiem(e){const t=e.split("|");t.length>1&&(e=t[0],this.setSearchText(t[0]));const a=e.split(","),n=/[0-9]/g;for(let o=0;o<a.length;o++){const e=a[o].split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),t=e.match(n),i=I(t.join(""));if("Dãy 10 chữ số cuối"===i)try{this.traCuuBHXH(t.join("").slice(-10))}catch(l){console.log(l)}else try{await this.traCuuMaSoBHXH({hoTen:e,maXa:this.userDetails.maXa,userName:this.userDetails.id,maHuyen:this.userDetails.maHuyen,maTinh:this.userDetails.maTinh})}catch(l){T.A.create({type:"negative",message:"Không thực hiện được!"+l})}}this.$refs.inputSearch.select(),a.length>1&&this.setSearchText("");const i={...this.$route.query,q:e};this.$router.replace({query:i})},async timMoi(e){const t=e.split(","),a=JSON.parse(localStorage.getItem("hoTens"))||[],n=t.filter((e=>!a.includes(e)));this.searchText=n.join(),this.timKiem(this.searchText)},async khoiTao(){this.resetBhyt([]),this.$route.query.key&&(this.key=await this.saveBHYT(this.$route.query.key))},async printDanhSachTraThe(){let e=document.createElement("a");e.target="_blank",e.href=`https://app.hotham.vn/danh-sach-tra-the/1/pdf?maSoBhxhs=${this.bhyts.map((e=>e.maSoBhxh)).join(",")}`,e.click()},copyMaSoBhxhToClipboard(){navigator.clipboard.writeText(this.bhyts.map((e=>e.maSoBhxh))).then((function(){T.A.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){T.A.create({type:"negative",message:"Không thực hiện được!"+e})}))},copySoDienThoaiToClipboard(){navigator.clipboard.writeText([...new Set(this.bhyts.map((e=>e.soDienThoai2||e.soDienThoai)))].join("\r\n")).then((function(){T.A.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){T.A.create({type:"negative",message:"Không thực hiện được!"+e})}))},copyNamePhoneClipboard(){const e=new Map;for(let t of this.bhyts)e.set(t.soDienThoai2||t.soDienThoai,t);this.download("NamePhone.csv","Name\tPhone\r\n"+[...new Set([...e.values()].map((({soDienThoai2:e,soDienThoai:t,hoTen:a,ngaySinhDt:n,denNgayDt:i,userName:l,soTheBhyt:o})=>`${a} T${new Date(i).getMonth()+1}${o?.slice(0,2)||""}${l==this.userDetails.id||l==this.userDetails.maNhanVienThu?"":"_"}${new Date(n).getFullYear()}\t${e||t}`))).values()].join("\r\n"))},download(e,t){var a=document.createElement("a");if(a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),document.createEvent){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),a.dispatchEvent(n)}else a.click()},async printPhuLucThanhVienHGD(){if(this.bhyts.length>15||0===this.bhyts.length)return void T.A.create({type:"negative",message:"Không thực hiện được!"});let e=document.createElement("a");e.target="_blank",e.href=`https://app.hotham.vn/thanh-vien-ho-gia-dinh/1/pdf?maXaUpdate=${this.userDetails.maXa}&maSoBhxhs=${this.bhyts.map((e=>e.maSoBhxh)).join(",")}`,e.click()}},watch:{getCurrentBhyt:function(e){this.dialogShow=!!e},userDetails:async function({maXa:e}){e&&x.api.post("/api/update-bhyt-data",{api_key:this.userDetails.isLogin,mang_luoi_id:this.userDetails.quaTrinhCongTac.mangLuoiId,force:!1}).then((e=>{console.log("Cập nhật dữ liệu Bhyt thành công!")})).catch((e=>{console.error("Lỗi cập nhật dữ liệu Bhyt:",e)}))}}};var Y=a(7716),V=a(492),U=a(9313),E=a(9519),Q=a(3999),M=a(7743),P=a(5173),O=a(9459),j=a(3796),K=a(386),R=a(2156);const G=(0,y.A)(q,[["render",d]]),J=G;W()(q,"components",{QPage:Y.A,QCard:B.A,QCardSection:f.A,QInput:D.A,QIcon:V.A,QSelect:U.A,QMenu:E.A,QList:Q.A,QItem:M.A,QItemSection:P.A,QExpansionItem:O.A,QItemLabel:j.A,QSeparator:K.A,QDialog:R.A}),W()(q,"directives",{ClosePopup:_.A})}}]);