"use strict";(globalThis["webpackChunktodolist"]=globalThis["webpackChunktodolist"]||[]).push([[948],{8567:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var i=a(1758),n=a(8790),l=a(9104);const s={class:"inline bg-orange-4 rounded-borders cursor-pointer"},h={class:"fit flex flex-center text-center non-selectable q-pa-md"},o=(0,i.Lk)("br",null,null,-1),c={class:"q-gutter-y-md column"},u=(0,i.Lk)("br",null,null,-1),r=(0,i.Lk)("br",null,null,-1);function d(e,t,a,d,T,g){const k=(0,i.g2)("q-item-section"),m=(0,i.g2)("q-item"),b=(0,i.g2)("q-list"),p=(0,i.g2)("q-menu"),y=(0,i.g2)("q-banner"),B=(0,i.g2)("q-icon"),f=(0,i.g2)("q-input"),H=(0,i.g2)("q-badge"),C=(0,i.g2)("q-item-label"),X=(0,i.g2)("ThongTinTheBHYT"),_=(0,i.g2)("q-separator"),v=(0,i.g2)("q-page"),W=(0,i.gN)("close-popup");return(0,i.uX)(),(0,i.Wv)(v,{class:""},{default:(0,i.k6)((()=>[(0,i.bF)(y,{"inline-actions":"",class:(0,n.C4)(["bg-orange-4","list-header text-white text-center"])},{default:(0,i.k6)((()=>[(0,i.Lk)("div",s,[(0,i.Lk)("div",h,[(0,i.eW)(" Bấm vào đây để tra cứu thông tin "),o,(0,i.eW)(" (Hạn sử dụng: "+(0,n.v_)(e.userDetails?.hetHan)+") ",1)]),(0,i.bF)(p,{"touch-position":""},{default:(0,i.k6)((()=>[(0,i.bF)(b,{style:{"min-width":"100px"}},{default:(0,i.k6)((()=>[(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytByName},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tìm tất cả")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.printPhuLucThanhVienHGD},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("In phụ lục thành viên HGD")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[0]||(t[0]=e=>g.loadBhytByUserName(1))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đã thu tiền BHYT")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[1]||(t[1]=e=>g.loadBhytByUserName(0))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đã thu tiền BHXH")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.taiTucBHYT1thang},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục 1 tháng (Me)")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.taiTucBHYT2thang},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục 2 tháng (Me)")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[2]||(t[2]=e=>g.loadBhyts({thang:1}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục 1 tháng (All)")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[3]||(t[3]=e=>g.loadBhyts({thang:2}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục 2 tháng (All)")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[4]||(t[4]=t=>g.loadBHXHTNs({tienNop:1,taiTucBHXH:1,disabled:"0",completed:"0",userName:e.userDetails.id}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục BHXH (1 tháng)")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[5]||(t[5]=t=>g.loadBHXHTNs({tienNop:1,userName:e.userDetails.id}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("BHXH (me)")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[6]||(t[6]=t=>g.loadBHXHTNs({tienNop:1,maXa:e.userDetails.maXa}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("BHXH (All)")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadTaiTucBHYTBT},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("BHYT bổ trợ")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytsHetHan},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đã hết hạn")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytsDisable},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đã liên hệ")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytsCompleted},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đánh dấu sao")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytThang},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Biên thu BHYT")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBHXHThang},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Biên thu BHXH TN")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBaoCaoChiTietGiaoDich},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Báo cáo Chi Tiết Giao Dịch")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.inC17},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("In C17")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.printDanhSachTraThe},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("In Danh sách trả thẻ")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.copyMaSoBhxhToClipboard},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Copy tất cả mã số BHXH")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:e.copyHoTenToClipboard},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Copy tất cả họ tên")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.copySoDienThoaiToClipboard},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Copy tất cả số điện thoại")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.copyNamePhoneClipboard},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Lưu danh bạ")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:e.batTatRemove},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tắt/Bật danh sách")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[7]||(t[7]=e=>g.timMoi(T.searchText))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tìm mới")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadBhytByNamSinh},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tìm theo năm sinh")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadTaiTucBHYT},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục BHYT (ssm)")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:g.loadTaiTucBHXH},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục BHXH (ssm)")])),_:1})])),_:1},8,["onClick"])),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[8]||(t[8]=t=>e.capNhatBHXHTN(T.searchText))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đồng bộ BHXH TN")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[9]||(t[9]=t=>e.resetBhyt(T.searchText?e.bhyts.filter((e=>e.userName!==T.searchText)):[]))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Xóa danh sách")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[10]||(t[10]=t=>e.resetBhyt(T.searchText?e.bhyts.filter((e=>e.userName===T.searchText)):[]))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Giữ lại danh sách")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[11]||(t[11]=t=>e.resetBhyt(T.searchText?e.bhyts.filter((e=>!(e.soDienThoai||e.soDienThoai2))):[]))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Thiếu số điện thoại")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[12]||(t[12]=t=>g.loadBHXHTNs({isCMND:1,maXa:e.userDetails.maXa}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Thiếu CCCD")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[13]||(t[13]=e=>g.loadBhytByUserNameTaiTuc())},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Tái tục")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[14]||(t[14]=t=>e.getBhyts({isPhone:!0,maXa:e.userDetails.maXa,name:T.searchText}))},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Có số điện thoại")])),_:1})])),_:1})),[[W]]),(0,i.bo)(((0,i.uX)(),(0,i.Wv)(m,{clickable:"",onClick:t[15]||(t[15]=e=>g.loadBhytByUserName())},{default:(0,i.k6)((()=>[(0,i.bF)(k,null,{default:(0,i.k6)((()=>[(0,i.eW)("Đã thu tiền")])),_:1})])),_:1})),[[W]])])),_:1})])),_:1})])])),_:1}),(0,i.Lk)("div",c,[(0,i.bF)(f,{outlined:"",modelValue:T.searchText,"onUpdate:modelValue":t[17]||(t[17]=e=>T.searchText=e),ref:"inputSearch",onKeyup:t[18]||(t[18]=(0,l.jR)((e=>g.timKiem(T.searchText)),["enter"])),dense:""},{append:(0,i.k6)((()=>[""!==T.searchText?((0,i.uX)(),(0,i.Wv)(B,{key:0,name:"close",onClick:t[16]||(t[16]=e=>T.searchText=""),class:"cursor-pointer"})):(0,i.Q3)("",!0),(0,i.bF)(B,{name:"search"})])),_:1},8,["modelValue"])]),(0,i.bF)(b,null,{default:(0,i.k6)((()=>[(0,i.bF)(C,{header:""},{default:(0,i.k6)((()=>[(0,i.eW)(" Số lượng: "),(0,i.bF)(H,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,n.v_)(e.bhyts.length),1)])),_:1}),(0,i.eW)("/Trung bình đóng: "+(0,n.v_)(parseInt(e.tongTienBHYT/(e.bhyts.length||1)).toLocaleString())+"/Hoa hồng: "+(0,n.v_)(parseInt((e.tongTienBHYT/(e.bhyts.length||1)*.0264).toFixed(0)).toLocaleString())+"đ/thẻ",1),u,(0,i.eW)(" Tổng tiền: "),(0,i.bF)(H,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,n.v_)(parseInt(e.tongTienBHYT).toLocaleString()),1)])),_:1}),(0,i.eW)(" : Hoa hồng: "+(0,n.v_)(parseInt((.0264*e.tongTienBHYT).toFixed(0)).toLocaleString())+"đ ",1),r,(0,i.eW)(" BHXHTN : "),(0,i.bF)(H,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,n.v_)(parseInt(e.tongTienBHXH).toLocaleString()),1)])),_:1})])),_:1}),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.bhyts,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id},[(0,i.bF)(X,{bhyt:e},null,8,["bhyt"]),(0,i.bF)(_,{spaced:"",inset:""})])))),128))])),_:1})])),_:1})}a(3009),a(3647),a(7458),a(1807),a(5512),a(5263),a(9875),a(4559);var T=a(6980),g=a(3214),k=a(1627);const m={components:{ThongTinTheBHYT:g.A},data(){return{searchText:"",tuNgayDenNgay:"",soBienLai:""}},computed:{...(0,T.L8)("bhyts",["bhyts","tongTienBHYT","tongTienBHXH"]),...(0,T.aH)("auth",["userDetails"])},methods:{...(0,T.i0)("bhyts",["getBhyts","resetBhyt","traCuuBhyts","updateBhyt","hoSoDaXuLy","dongBoDuLieu","traCuuTheoTen","getDanhSachKhachHangTaiTuc","copyHoTenToClipboard","batTatRemove","capNhatBHXHTN"]),...(0,T.i0)("auth",["firebaseUpdateUser","handleAuthStateChanged"]),sleep(e){return new Promise((t=>setTimeout(t,e)))},taiTucBHYT1thang(){this.searchText=this.userDetails.id,this.getBhyts({thang:1,completed:"0",disabled:"0",taiTuc:"1",userName:this.userDetails.id})},taiTucBHYT2thang(){this.searchText=this.userDetails.id,this.getBhyts({thang:2,completed:"0",disabled:"0",taiTuc:"1",userName:this.userDetails.id})},async loadTaiTucBHXH(){const e=await this.getDanhSachKhachHangTaiTuc({filterItems:[],maxResultCount:500,skipCount:0,mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId,tuThang:"2020-01-01 00:00:00",denThang:"2025-01-01 00:00:00",type:-1,loaiDichVu:0});this.capNhatBHXHTN([...new Set(e.map((e=>e.maSoBHXH)))].join())},async loadTaiTucBHYT(){const e=await this.getDanhSachKhachHangTaiTuc({filterItems:[],maxResultCount:5e3,skipCount:0,mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId,tuThang:"2020-01-01 00:00:00",denThang:"2025-01-01 00:00:00",type:-1,loaiDichVu:1});this.dongBoDuLieu([...new Set(e.map((e=>e.maSoBHXH)))].join())},async loadBaoCaoChiTietGiaoDich(){const e=new Date,t=e.getFullYear(),a=e.getMonth();2!==this.searchText.split(" : ").length&&(this.tuNgayDenNgay=this.searchText=`${new Date(t,a-2,1).toISOString().slice(0,10)} : ${new Date(2024,12,31).toISOString().slice(0,10)}`),this.$q.dialog({title:"Báo cáo chi tiết giao dịch",message:"Từ ngày : đến ngày?",prompt:{model:this.searchText,type:"text"},cancel:!0,persistent:!0}).onOk((async e=>{const t=e.split(" : ");try{await this.hoSoDaXuLy({tuNgay:t[0],denNgay:t[1],mangLuoiId:this.userDetails.quaTrinhCongTac.mangLuoiId})}catch(a){k.A.create({message:"Không thể kế nối đến máy chủ !",color:"red"})}}))},async inC17(){if(!this.bhyts.length&&!this.tuNgayDenNgay)return k.A.create({type:"negative",message:"Vào báo cáo giao dịch trước khi xuất C17."}),void this.loadBaoCaoChiTietGiaoDich();this.$q.dialog({title:"In C17 (quyển)",message:"Số biên lai?",prompt:{model:this.soBienLai,type:"text"},cancel:!0,persistent:!0}).onOk((async e=>{if(!e)return;const t=new Map;for(let s=1;s<10;s++)await t.set(`${e}0${s}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${e}0${s}`,ngayLap:null});for(let s=10;s<100;s++)await t.set(`${e}${s}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${e}${s}`,ngayLap:null});await t.set(`${parseInt(e+99)+1}`,{tongTien:0,tienBHYT:0,tienBHXH:0,soBienLai:`${parseInt(e+99)+1}`,ngayLap:null});const a=await this.bhyts.filter((t=>t.soBienLai.startsWith(e)));if(!a.length)return k.A.create({type:"negative",message:"Không tìm thấy quyển biên lai!"}),null;for(let s=0;s<this.bhyts.length;s++){const e=this.bhyts[s];if(t.has(e.soBienLai)){const a=t.get(e.soBienLai);t.set(e.soBienLai,{...a,ngayLap:e.ngayLap,tienBHYT:1===e.maThuTuc?parseInt(e.tongTien)+a.tienBHYT:a.tienBHYT,tienBHXH:0===e.maThuTuc?parseInt(e.tongTien)+a.tienBHXH:a.tienBHXH,tongTien:parseInt(e.tongTien)+a.tongTien})}}await this.sleep(1e3);const i=await fetch(`https://app.hotham.vn/api/mau-c17-all/1/pdf?tienBHYT=${a.filter((e=>1==e.maThuTuc)).map((e=>e.tongTien)).reduce(((e,t)=>e+t),0)}&tienBHXH=${a.filter((e=>0==e.maThuTuc)).map((e=>e.tongTien)).reduce(((e,t)=>e+t),0)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([...t.values()])}),n=await i.blob();if(n.errors)throw console.error(n.errors),new Error("Failed to fetch API");var l=document.createElement("a");l.href=window.URL.createObjectURL(n),l.download=`${(new Date).toISOString().slice(0,10)}-tham-tu-lap-c17.pdf`,l.click()}))},async print(e){let t=document.createElement("a");t.target="_blank";let a=`https://app.hotham.vn/mau-c17/${(new Date).toISOString().slice(0,10)}/pdf?maSoBhxhs=${e}`;t.href=a,t.click()},loadBhytByNamSinh(){this.$q.dialog({title:"Tìm thẻ BHYT theo năm sinh",message:"Nhập năm sinh?",prompt:{model:this.searchText,isValid:e=>4==e.length,type:"number"},cancel:!0,persistent:!0}).onOk((e=>{e&&(this.searchText=e),this.getBhyts({completed:"0",disabled:"0",maXa:this.userDetails.maXa,nam:e})}))},loadBhytByUserNameTaiTuc(){this.getBhyts({userName:this.searchText,completed:"0",disabled:"0"})},loadBhytByUserName(e){this.searchText||(this.searchText=this.userDetails.maNhanVienThu),1===e?this.getBhyts({userName:this.userDetails.maNhanVienThu,isBHYT:1}):0===e?this.getBhyts({userName:this.userDetails.maNhanVienThu,isBHXHTN:1}):this.getBhyts({userName:this.searchText})},loadBhytByName(){this.$q.dialog({title:"Tìm thẻ BHYT",message:"Nhập nội dung tìm kiếm?",prompt:{model:this.searchText,isValid:e=>e.length>=2,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.searchText=e,this.getBhyts({name:e,maXa:e.length<9?this.userDetails.maXa:null})}))},loadBhytThang(){this.$q.dialog({title:"Tháng biên lai",message:"Nhập tháng?",prompt:{model:this.searchText,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.searchText=e||(new Date).getMonth()+1,this.getBhyts({thangBienLai:this.searchText,userName:this.userDetails.id})}))},loadBHXHThang(){this.$q.dialog({title:"Tháng biên lai",message:"Nhập tháng?",prompt:{model:this.searchText,type:"text"},cancel:!0,persistent:!0}).onOk((e=>{this.searchText=e||(new Date).getMonth()+1,this.getBhyts({thangBienLaiTN:this.searchText,userName:this.userDetails.id})}))},loadBhyts({thang:e=1}){this.searchText="",this.getBhyts({thang:e,completed:"0",disabled:"0",taiTuc:"1",maXa:this.userDetails.maXa,name:this.searchText})},loadTaiTucBHYTBT(){this.searchText="",this.getBhyts({maXa:this.userDetails.maXa,taiTucBHYTBT:"1"})},loadBHXHTNs(e){this.getBhyts({...e,name:this.searchText})},loadBhytsHetHan(){this.getBhyts({maXa:this.userDetails.maXa,completed:"0",disabled:"0",hetHan:"1",name:this.searchText})},loadBhytsDisable(){this.getBhyts({maXa:this.userDetails.maXa,disabled:1})},loadBhytsCompleted(){this.getBhyts({maXa:this.userDetails.maXa,completed:1,disabled:"0"})},async timKiem(e){const t=e.split("|");t.length>1&&(this.searchText=e=t[0]);const a=e.split(","),i=/[0-9]/g;for(let s=0;s<a.length;s++){const t=a[s].split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),n=t.match(i);if(n){if(1===a.length)try{await this.getBhyts({name:n.join(""),maXa:n.length<9?this.userDetails.maXa:null})}catch(l){}await this.dongBoDuLieu(n.join("")),await this.sleep(500)}else try{await this.traCuuTheoTen({name:t,maXa:this.userDetails.maXa,maHuyen:this.userDetails.maHuyen,maTinh:this.userDetails.maTinh})}catch(l){k.A.create({type:"negative",message:"Không thực hiện được!"+l}),a.length,await this.traCuuBhyts({searchText:e,maXa:this.userDetails.maXa})}}this.$refs.inputSearch.select();const n={...this.$route.query,q:e};this.$router.replace({query:n})},async timMoi(e){const t=e.split(","),a=JSON.parse(localStorage.getItem("hoTens"))||[],i=t.filter((e=>!a.includes(e)));this.searchText=i.join(),this.timKiem(this.searchText)},async khoiTao(){this.resetBhyt([]),this.$route.query.key&&(this.key=await this.saveBHYT(this.$route.query.key))},async printDanhSachTraThe(){let e=document.createElement("a");e.target="_blank",e.href=`https://app.hotham.vn/danh-sach-tra-the/1/pdf?maSoBhxhs=${this.bhyts.map((e=>e.maSoBhxh)).join(",")}`,e.click()},copyMaSoBhxhToClipboard(){navigator.clipboard.writeText(this.bhyts.map((e=>e.maSoBhxh))).then((function(){k.A.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){k.A.create({type:"negative",message:"Không thực hiện được!"+e})}))},copySoDienThoaiToClipboard(){navigator.clipboard.writeText([...new Set(this.bhyts.map((e=>e.soDienThoai2||e.soDienThoai)))].join("\r\n")).then((function(){k.A.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){k.A.create({type:"negative",message:"Không thực hiện được!"+e})}))},copyNamePhoneClipboard(){const e=new Map;for(let t of this.bhyts)e.set(t.soDienThoai2||t.soDienThoai,t);this.download("NamePhone.csv","Name\tPhone\r\n"+[...new Set([...e.values()].map((({soDienThoai2:e,soDienThoai:t,hoTen:a,ngaySinhDt:i,denNgayDt:n,userName:l,soTheBhyt:s})=>`${a} T${new Date(n).getMonth()+1}${s?.slice(0,2)||""}${l==this.userDetails.id||l==this.userDetails.maNhanVienThu?"":"_"}${new Date(i).getFullYear()}\t${e||t}`))).values()].join("\r\n"))},download(e,t){var a=document.createElement("a");if(a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),document.createEvent){var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),a.dispatchEvent(i)}else a.click()},async printPhuLucThanhVienHGD(){if(this.bhyts.length>15||0===this.bhyts.length)return void k.A.create({type:"negative",message:"Không thực hiện được!"});let e=document.createElement("a");e.target="_blank",e.href=`https://app.hotham.vn/thanh-vien-ho-gia-dinh/1/pdf?maXaUpdate=${this.userDetails.maXa}&maSoBhxhs=${this.bhyts.map((e=>e.maSoBhxh)).join(",")}`,e.click()}},async created(){if(this.$route.query.q){const e=this.$route.query.q;this.searchText=e,await this.sleep(1e3),this.timKiem(e)}}};var b=a(2807),p=a(7716),y=a(6868),B=a(9519),f=a(3999),H=a(7743),C=a(5173),X=a(2801),_=a(492),v=a(3796),W=a(3954),D=a(386),x=a(8672),N=a(8582),F=a.n(N);const S=(0,b.A)(m,[["render",d]]),w=S;F()(m,"components",{QPage:p.A,QBanner:y.A,QMenu:B.A,QList:f.A,QItem:H.A,QItemSection:C.A,QInput:X.A,QIcon:_.A,QItemLabel:v.A,QBadge:W.A,QSeparator:D.A}),F()(m,"directives",{ClosePopup:x.A})}}]);