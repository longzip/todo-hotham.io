"use strict";(self["webpackChunktodo_buudienxatulap"]=self["webpackChunktodo_buudienxatulap"]||[]).push([[615],{4026:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(9835),o=n(6970);const s={class:"text-bold text-subtitle1"};function i(e,t,n,i,r,c){const d=(0,a.up)("q-banner");return(0,a.wg)(),(0,a.j4)(d,{dense:"","inline-actions":"",class:(0,o.C_)([n.bgcolor,"list-header text-white text-center"])},{default:(0,a.w5)((()=>[(0,a._)("span",s,[(0,a.WI)(e.$slots,"default")])])),_:3},8,["class"])}const r={props:["bgcolor"]};var c=n(1639),d=n(7128),h=n(9984),l=n.n(h);const u=(0,c.Z)(r,[["render",i]]),p=u;l()(r,"components",{QBanner:d.Z})},615:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(9835),o=n(6970),s=n(1957);const i={class:"q-pa-md"},r={class:"q-gutter-y-md column"},c=["href"];function d(e,t,n,d,h,l){const u=(0,a.up)("q-btn"),p=(0,a.up)("ListHeader"),g=(0,a.up)("q-icon"),m=(0,a.up)("q-input"),w=(0,a.up)("q-item-label"),f=(0,a.up)("q-item-section"),k=(0,a.up)("q-item"),y=(0,a.up)("q-separator"),T=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(p,{bgcolor:"bg-orange-4"},{default:(0,a.w5)((()=>[(0,a.Uk)("KHL "+(0,o.zw)(e.searchText)+" "+(0,o.zw)(e.doanhThu.toLocaleString())+"đ / "+(0,o.zw)(e.tongSoBuuGui)+" bưu gửi ",1),(0,a.Wm)(u,{rounded:"",color:"primary",onClick:t[0]||(t[0]=t=>e.copySoDienThoaiToClipboard()),icon:"content_copy"})])),_:1}),(0,a._)("div",r,[(0,a.Wm)(m,{outlined:"",modelValue:e.searchText,"onUpdate:modelValue":t[2]||(t[2]=t=>e.searchText=t),placeholder:"Từ khóa",hint:"Tìm kiếm theo thông tin thẻ BHYT",onKeyup:t[3]||(t[3]=(0,s.D2)((t=>e.traCuu()),["enter"])),dense:""},{append:(0,a.w5)((()=>[""!==e.searchText?((0,a.wg)(),(0,a.j4)(g,{key:0,name:"close",onClick:t[1]||(t[1]=t=>e.searchText=""),class:"cursor-pointer"})):(0,a.kq)("",!0),(0,a.Wm)(g,{name:"search"})])),_:1},8,["modelValue"])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.khls.sort((function(e,t){return t.soLuong-e.soLuong})),(e=>((0,a.wg)(),(0,a.j4)(T,{key:e.senderPhone},{default:(0,a.w5)((()=>[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.senderName),1)])),_:2},1024),(0,a.Wm)(w,{caption:"",lines:"2"},{default:(0,a.w5)((()=>[(0,a._)("a",{href:`tel:${e.senderPhone}`},(0,o.zw)(e.senderPhone),9,c)])),_:2},1024),(0,a.Wm)(w,{caption:"",lines:"2"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.senderAdd),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(f,{side:"",top:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.soLuong),1)])),_:2},1024),(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)("COD: "+(0,o.zw)(parseInt(e.tongCOD).toLocaleString()),1)])),_:2},1024),(0,a.Wm)(w,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)("Cước: "+(0,o.zw)(parseInt(e.tongCuoc).toLocaleString()),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.Wm)(y,{spaced:"",inset:""})])),_:2},1024)))),128))])}n(702);var h=n(9981),l=n.n(h),u=n(6827),p=n(6950),g=n(8359),m=n(4026);const w=(0,a.aZ)({components:{ListHeader:m.Z},name:"KHLPage",data(){const[e,t,n]=(new Date).toISOString().slice(0,10).split("-");return{ngay:n,thang:t,nam:e,searchText:[t,e].join("/"),tokenFe:"",dsDonHang:[],khls:[],tongSoBuuGui:0,doanhThu:0}},methods:{sleep(){return new Promise((e=>setTimeout(e,1500)))},async login(){var e=JSON.stringify({username:"142010_THAMHT",password:"Abc@123456789",ip:"",random:.8677049060452371}),t={method:"post",maxBodyLength:1/0,url:"https://api-portalkhl.vnpost.vn/api/auth/signinKhl",headers:{capikey:"19001235","Content-Type":"application/json"},data:e};const{data:{tokenFe:n}}=await l().post("https://api-portalkhl.vnpost.vn/api/auth/signinKhl",e,t);this.tokenFe=n},async loadData(){this.dsDonHang=[],this.tokenFe||await this.login();var e=JSON.stringify({orgCode:"142010",tuNgay:[1,parseInt(this.thang),this.nam].join("/"),denNgay:new Date(this.nam,parseInt(this.thang),1).toISOString().slice(0,10).split("-").reverse().join("/"),pageNum:0,pageSize:5e3,sourceSystem:"KHL"}),t={method:"post",maxBodyLength:1/0,url:"https://api-portalkhl.vnpost.vn/khl/getItemDtl",headers:{Authorization:`Bearer ${this.tokenFe}`,"Content-Type":"application/json"},data:e};p.Z.show({spinner:g.Z,spinnerSize:"100px"});const{data:[n,a]}=await l()(t);this.tongSoBuuGui=n,this.doanhThu=a.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0),p.Z.hide(),this.dsDonHang=a;const o=new Map,s=a.map((({senderPhone:e,senderName:t,senderAdd:n})=>({senderPhone:e,senderName:t,senderAdd:n})));for(let i=0;i<s.length;i++){const e=s[i];if(!o.has(e.senderPhone)){const t=a.filter((t=>t.senderPhone===e.senderPhone));o.set(e.senderPhone,{...e,soLuong:t.length,tongCuoc:t.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0),tongCOD:t.filter((e=>e.codAmount)).reduce(((e,{codAmount:t})=>e+parseInt(t)),0)})}}this.khls=[...o.values()]},async traCuu(){const[e,t]=this.searchText.split("/");this.thang=e,this.nam=t,this.loadData()},async findItems(e){return this.dsDonHang.filter((t=>t.senderPhone===e))},async tongCuoc(e){return e.reduce(((e,{totalFeeSpecial:t})=>e+parseInt(t)),0)},async updateItem({ttNumber:e,senderPhone:t,totalFeeSpecial:n,codAmount:a,updatedDate:o,createdDate:s}){l().put(`https://192.168.1.7:2024/api/khls/${e}`,{soTien:n,ghiNo:a,ten:t,updatedDate:o.toString().slice(0,10),createdDate:s.toString().slice(0,10)})},copyTextToClipboard(e){navigator.clipboard.writeText(`Để theo dõi định vị bưu gửi https://www.hotham.vn/tra-cuu-hang-buu-dien?q=${e}. (Bạn chỉ cần bấm vào link)`).then((function(){u.Z.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){u.Z.create({type:"negative",message:"Không thực hiện được!"+e})}))},copySoDienThoaiToClipboard(){navigator.clipboard.writeText(this.khls.map((e=>e.senderPhone)).join()).then((function(){u.Z.create({type:"positive",message:"Bạn đã sao chép thành công!"})}),(function(e){u.Z.create({type:"negative",message:"Không thực hiện được!"+e})}))}},mounted(){this.loadData()}});var f=n(1639),k=n(4455),y=n(361),T=n(2857),v=n(3246),b=n(490),S=n(1233),D=n(3115),Z=n(2218),_=n(9984),C=n.n(_);const x=(0,f.Z)(w,[["render",d]]),I=x;C()(w,"components",{QBtn:k.Z,QInput:y.Z,QIcon:T.Z,QList:v.Z,QItem:b.Z,QItemSection:S.Z,QItemLabel:D.Z,QSeparator:Z.Z})}}]);